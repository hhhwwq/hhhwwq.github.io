---
title: 图解HTTP
date: 2019-12-1 10:43:53
tags: "HTTP"

---

第一，二章 Web基础，HTTP协议 
============================


第一章 了解Web及网络基础
------------------------

### 1.3 网络基础TCP/IP 的分层管理 

-   应用层：为用户提供应用服务。**DNS（域名系统）、FTP（文件传输协议）、HTTP也在应用层**。

-   传输层：对上层应用层，提供两台计算机之间的数据传输。**TCP（传输控制协议）、UDP（用户数据报协议）属于传输层**。

-   网络层：处理网上流动的数据包，选择通过怎样的路径，把数据包给对方。**IP（网际协议）属于网络层。**

-   数据链路层/网络接口层：处理链接网络的硬件部分。
    **包括控制操作系统、硬件设备的驱动、NIC（网络适配器，即网卡）**

### 1.4.2 TCP的三次握手：确保数据能到达目标 

1.  发送端受限发送一个带SYN标志的数据包给对方。
2.  接收端收到后，回传一个带有SYN/ACK标志的数据包传达确认信息。
3.  最后，发送端再回传一个带ACK标志的数据包，代表握手结束。
    ![pic\_1](https://github.com/hhhwwq/MarkdownPhotos/blob/master/woshou.jpg?raw=true)

第二章 简单的HTTP协议
---------------------

> 请求报文是由请求方法、请求URI（统一资源标识符，URL：统一资源定位符）、协议版本、可选的请求收不字段和内容实体构成。

### 2.3HTTP是不保存状态的协议 

HTTP是一种不保存状态，即无状态协议。HTTP协议自身不对请求和响应之间的通信状态进行保存，不做持久化处理。

### 2.5 告知服务器意图的HTTP方法 

1.  GET：获取资源
2.  POST：传输实体主体
3.  PUT：传输文件
4.  HEAD：获得报文首部，告知通信状态
5.  DELETE：删除文件
6.  OPTIONS：询问支持的方法
7.  TRACE：追踪路径

### 2.8 使用Cookie的状态管理 

Cookie会根据从**服务器端**发送的**响应报文内**的一个叫做Set-Cookie的首部字段信息，通知**客户端保存Cookie**，当**下次客户端**再往该服务器**发送请求**时，客户端会自动在**请求报文中加入Cookie值**后发送出去。服务器端根据客户端发过来的cookie对比服务器上的记录，最后得到之前的状态信息。即：

1.  请求报文（没有Cookie信息的状态）；
2.  响应报文（服务端生成Cookie信息）；
3.  请求报文（自动发送保存着的Cookie信息）。

Cookie技术通过在请求和响应报文中写入Cookie信息来控制客户端的状态。



第三，四章 HTTP报文内的HTTP信息，状态码 
=======================================

第3章 HTTP报文内的HTTP信息
--------------------------

### 3.2 请求报文及响应报文的结构 

![pic\_2](https://github.com/hhhwwq/MarkdownPhotos/blob/master/baowen.jpg?raw=true)

请求行： 包括**请求方法，请求URI和HTTP版本**(get /index.htm /HTTP/1.1）

状态行：包括表明相应结果的**状态码，HTTP版本和原因短语** （HTTP/1.1
200OK）

首部字段： 表示请求的各种条件和属性的各类首部

分为： 通用首部，请求首部，响应首部，实体首部。

其他: HTTP的RFC里未定义的首部（cookie等）

### 3.3.1 报文主体和实体主体的差异 

-   报文

> HTTP通信中的基本单位。

-   实体 作为请求或响应的有效载荷数据（补充项）被传输

通常情况下，两者一样，只有当传输中进行编码操作时，实体主体的内容发生变化，才导致它和报文主体产生差异。

第4章 返回结果的HTTP状态码
--------------------------

![pic\_3](https://github.com/hhhwwq/MarkdownPhotos/blob/master/zhuangtaima.jpg?raw=true)

-   200 OK 的响应结果表明请求被**正常处理**了。
-   204 No Content
    服务器接收的请求已成功处理，但在返回的**响应报文中不含实体的主体部分**。
-   206 Partial Content **客户端**进行了**范围请求**。

* * * * *

-   301 Moved Permanently
    永久性重定向。表示请求的资源已被分配了新的URI，**以后**应使用新URI。
-   302 Found
    临时性重定向。表示请求的资源已被分配了新的URI，**本次**请求暂且使用新URI。
-   307 Temporary Redirect
    临时性重定向。与**302含义相同**。(不会从post变成get)
-   303 See Other
    由于**请求对应的资源存在着另一个URI**，应使用**GET**方法定向获取请求的资源。
-   304 Not Modified
    客户端发送的附带条件的请求时，服务器允许请求访问资源，但服务器端资源未改变，可直接**使用客户端未过期的缓存**。

* * * * *

-   400 Bad Request 请求报文中存在语法错误。
-   401 Unauthorized
    请求需要通过HTTP认证。第一次返回，会弹出认证窗口，第二次返回，表示认证失败。
-   403 Forbidden 请求资源的访问被服务器拒绝了。
-   404 Not Found 服务器上**没有请求的资源**。

* * * * *

-   500 Internal Server Error **服务器在执行请求**时发生了错误。
-   503 Service Unavailable
    服务器暂时处于超负载或正在进行停机维护，现在无法处理请求。


第五，六章 缓存，通信转发程序，HTTP首部字段 
===========================================


保存资源的缓存
--------------

> 缓存是指**代理服务器或客户端本地磁盘**内保存的资源副本。

缓存是有有效期限的，若缓存失效，缓存服务器将会再次从源服务器上获取“新”资源。

缓存不仅可以存在于缓存服务器内，还可以存在于客户端浏览器中。浏览器缓存如果有效，就不必再向服务器请求相同的资源了，可以直接从本地磁盘内获取。和缓存服务器相同的是，客户端的缓存也会过期。

通信转发程序
------------

代理：客户端和服务器的中间人。代理不改变URI。

-   常用：**缓存代理**（代理转发响应时，会保存资源在代理服务器上，再次请求相同资源时即可不去源服务器获取资源；有有效期，过期后会确认资源有效性，无效就再次获取新资源）；通过设置组织内部的代理服务器可做到针对特定URI访问的控制。

网关：为客户端和网关之间的通信线路加密，提高通信的**安全性，可以由HTTP请求转化为其他协议通信**。比如在Web购物网站上进行信用卡结算时，网关可以和信用卡结算系统联动。

隧道：确保客户端与服务器安全通信，建立一条与其他服务器的通信线路。不会去解析HTTP请求。**可以与远距离的服务器安全通信，是透明的。**

HTTP首部字段
------------

> 首部字段名:字段值

### 4种首部字段类型 

根据实际用途被分为一下4种类型：

1.  **通用首部字段:** 请求报文和响应报文都会使用的首部

    可以操作缓存的字段:Cache-Control。表示是否能缓存的指令：public，no-cache；控制可执行的缓存对象的指令：no-store；指定缓存期限和认证的指令：s-maxage指令，max-age指令，min-fresh指令，max-stale指令。

2.  **请求首部字段:**
    客户端发请求报文给服务器时使用，补充请求附加内容、客户端信息、相应内容相关优先级等；

    Accept
    通知服务器，用户代理能够处理的媒体类型及其相对优先级，可采用type/subtype形式；
    Host
    通知服务器，请求的资源所处的互联网主机名和端口号（HTTP/1.1规范内，Host是唯一一个必须项）；

3.  **响应首部字段:**
    服务器返回响应报文给客户端时使用，补充响应附加内容，要求客户端附加额外的内容信息；

    Accept-Ranges：告知客户端，能（bytes）否（none）处理范围请求；

4.  **实体首部字段:**
    请求报文和响应报文的实体部分使用的，补充资源内容更新时间等。

    Expires：将资源失效的日期告知客户端，超过时间的，缓存服务器会向源服务器请求资源。（**源服务器不希望缓存服务器对资源缓存时，最好在Expires字段内写入与首部字段Date相同的时间值。**）（但当首部字段Cache-Control指定了max-age指令时，优先处理max-age）

第七章 HTTPS,Cookie
===================

HTTP的缺点
----------

-   通信使用明文（不加密），内容可能会被窃听\
-   不验证通信方的身份，因此有可能遭遇伪装
-   无法证明报文的完整性，所以有可能已造篡改

### HTTP其他缺点：

-   一条连接上只可发送一个请求；
-   请求只能从用户端开始，客户端不可以接收除响应以外的指令；
-   请求/响应首部未经压缩就发送。首部信息越多，延迟越大；
-   发送冗长的首部，每次互相发送相同的首部造成的浪费较多；
-   可任意选择数据压缩格式， 非强制压缩发送；
-   解决办法：Ajax、Comet、SPDY、WebSocket（Web浏览器和Web服务器之间全双工通信标准）

**HTTP+加密+认证+完整性保护=HTTPS（身披SSL协议外壳的HTTP)**

Cookie技术
----------

HTTP协议自身**不具备保存**之前发送过的请求或响应的功能，即无状态协议。
为了实现期望的保持状态功能，于是引入了Cookie技术。

-   Cookie技术通过在请求和响应报文中写入Cookie信息来控制客户端的状态。

-   Cookie会根据从**服务器端**发送的**响应报文**内的一个叫做**Set-Cookie**的首部字段信息，通知客户端保存Cookie。当下次客户端再往该服务器发送请求时，客户端会**自动在请求报文中加入Cookie**值后发送出去。

为Cookie服务的首部字段
----------------------

Cookie的工作机制是用户识别及状态管理。Web网站通过Web浏览器，把一些数据写入用户的计算机内。

  首部字段名   说明                             首部类型
  ------------ -------------------------------- --------------
  Set-Cookie   开始状态管理所使用的Cookie信息   响应首部字段
  Cookie       服务器接收到的Cookie信息         请求首部字段

-   Set-Cookie的几个属性：

expires=DATE： Cookie的有效期（默认为浏览器关闭前）；

    path=PATH：将服务器上的文件目录作为Cookie的适用对象；

    domain=域名： 作为Cookie使用对象的域名；

    **Secure：仅在HTTPS安全通信时才会发送Cookie**

    HttpOnly：加以限制，使Cookie不能被JavaScript脚本访问（防止跨站脚本攻击XSS）；